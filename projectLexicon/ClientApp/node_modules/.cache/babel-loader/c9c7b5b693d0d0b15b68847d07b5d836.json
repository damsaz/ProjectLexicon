{"ast":null,"code":"var _jsxFileName = \"/Users/bhrozdamsaz/Documents/GitHub/ProjectLexicon/projectLexicon/ClientApp/src/components/Chat/MessageList.js\";\nimport React, { useEffect, useState } from 'react';\nimport Compose from './Compose';\nimport Toolbar from './Toolbar';\nimport ToolbarButton from './ToolbarButton';\nimport Message from './Message';\nimport moment from 'moment';\nimport { Button } from \"reactstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Form from 'react-bootstrap/Form';\nimport { apiGet } from './api';\nimport { ErrBase } from '../ErrBase';\nimport axios from 'axios';\nimport './Style/MessageList.css';\nconst MY_USER_ID = 'apple';\nexport default function MessageList(_ref) {\n  let {\n    messages,\n    userP\n  } = _ref;\n  const [message, setMessage] = useState({\n    Text: \"\",\n    Sid: \"\",\n    Rid: \"\",\n    CreatedTime: new Date().getTime()\n  });\n  useEffect(() => {}, []);\n  const handleSubmit2 = event => {\n    event.preventDefault();\n    const form = event.target[0].value;\n    alert(form);\n    // setContactInfo({ FirstName: \"\", SecondName: \"\", Age: \"\", Nationality: \"\", EmailAdress: \"\"}); //reset form values after submit\n  };\n\n  const handleSubmit = event => {\n    event.preventDefault();\n    const newItem = apiGet(\"Messages/Add\", {\n      Text: event.target[0].value,\n      Rid: userP\n    });\n    if (newItem.errText) {\n      alert(newItem.errText);\n    }\n    renderMessages();\n  };\n  const renderMessages = () => {\n    let i = 0;\n    let messageCount = messages.length;\n    let tempMessages = [];\n    while (i < messageCount) {\n      let previous = messages[i - 1];\n      let current = messages[i];\n      let next = messages[i + 1];\n      let isMine = current.Sid != userP;\n      let currentMoment = moment(current.CreatedTime);\n      let prevBySameAuthor = false;\n      let nextBySameAuthor = false;\n      let startsSequence = true;\n      let endsSequence = true;\n      let showTimestamp = true;\n      if (previous) {\n        let previousMoment = moment(previous.timestamp);\n        let previousDuration = moment.duration(currentMoment.diff(previousMoment));\n        prevBySameAuthor = previous.author === current.author;\n        if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n          startsSequence = false;\n        }\n        if (previousDuration.as('hours') < 1) {\n          showTimestamp = false;\n        }\n      }\n      if (next) {\n        let nextMoment = moment(next.timestamp);\n        let nextDuration = moment.duration(nextMoment.diff(currentMoment));\n        nextBySameAuthor = next.author === current.author;\n        if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n          endsSequence = false;\n        }\n      }\n      console.log(isMine);\n      tempMessages.push( /*#__PURE__*/React.createElement(Message, {\n        key: i,\n        isMine: isMine,\n        startsSequence: false,\n        endsSequence: false,\n        showTimestamp: showTimestamp,\n        data: current,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 9\n        }\n      }));\n\n      // Proceed to the next message.\n      i += 1;\n    }\n    return tempMessages;\n  };\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"message-list\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Toolbar, {\n    title: \"Conversation Title\",\n    rightItems: [/*#__PURE__*/React.createElement(ToolbarButton, {\n      key: \"info\",\n      icon: \"ion-ios-information-circle-outline\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(ToolbarButton, {\n      key: \"video\",\n      icon: \"ion-ios-videocam\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 13\n      }\n    }), /*#__PURE__*/React.createElement(ToolbarButton, {\n      key: \"phone\",\n      icon: \"ion-ios-call\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 13\n      }\n    })],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"message-list-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }, renderMessages()), /*#__PURE__*/React.createElement(Form, {\n    className: \"compose\",\n    onSubmit: handleSubmit,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"input\", {\n    type: \"text\",\n    className: \"compose-input\",\n    placeholder: \"Type a message, @name\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 17\n    }\n  }), /*#__PURE__*/React.createElement(Button, {\n    type: \"submit\",\n    color: \"primary\",\n    className: \"bi bi-send\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129,\n      columnNumber: 17\n    }\n  }, \"Send\")));\n}","map":{"version":3,"names":["React","useEffect","useState","Compose","Toolbar","ToolbarButton","Message","moment","Button","Form","apiGet","ErrBase","axios","MY_USER_ID","MessageList","messages","userP","message","setMessage","Text","Sid","Rid","CreatedTime","Date","getTime","handleSubmit2","event","preventDefault","form","target","value","alert","handleSubmit","newItem","errText","renderMessages","i","messageCount","length","tempMessages","previous","current","next","isMine","currentMoment","prevBySameAuthor","nextBySameAuthor","startsSequence","endsSequence","showTimestamp","previousMoment","timestamp","previousDuration","duration","diff","author","as","nextMoment","nextDuration","console","log","push"],"sources":["/Users/bhrozdamsaz/Documents/GitHub/ProjectLexicon/projectLexicon/ClientApp/src/components/Chat/MessageList.js"],"sourcesContent":["import React, {useEffect, useState} from 'react';\nimport Compose from './Compose';\nimport Toolbar from './Toolbar';\nimport ToolbarButton from './ToolbarButton';\nimport Message from './Message';\nimport moment from 'moment';\nimport { Button } from \"reactstrap\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Form from 'react-bootstrap/Form';\nimport { apiGet } from './api';\nimport { ErrBase } from '../ErrBase';\nimport axios from 'axios';\n\nimport './Style/MessageList.css';\n\nconst MY_USER_ID = 'apple';\n\nexport default function MessageList({ messages, userP }) {\n  \n    const [message, setMessage] = useState({\n        Text: \"\",\n        Sid: \"\",\n        Rid: \"\",\n        CreatedTime: new Date().getTime()\n    })\n    useEffect(() => {\n       \n\n     \n        \n  },[])\n    const handleSubmit2 = (event) => {\n        event.preventDefault();\n        const form = event.target[0].value\n        alert(form);\n        // setContactInfo({ FirstName: \"\", SecondName: \"\", Age: \"\", Nationality: \"\", EmailAdress: \"\"}); //reset form values after submit\n\n    };\n    const handleSubmit = (event) =>{\n  \n        event.preventDefault();\n       \n        const newItem = apiGet(\"Messages/Add\", { Text: event.target[0].value, Rid: userP ,});\n        if (newItem.errText) {\n            alert(newItem.errText);\n        }\n        renderMessages();\n    }\n\n\n  const renderMessages = () => {\n    let i = 0;\n    let messageCount = messages.length;\n    let tempMessages = [];\n\n    while (i < messageCount) {\n      let previous = messages[i - 1];\n      let current = messages[i];\n        let next = messages[i + 1];\n        let isMine = current.Sid != userP;\n        let currentMoment = moment(current.CreatedTime);\n      let prevBySameAuthor = false;\n      let nextBySameAuthor = false;\n      let startsSequence = true;\n      let endsSequence = true;\n      let showTimestamp = true;\n\n      if (previous) {\n        let previousMoment = moment(previous.timestamp);\n        let previousDuration = moment.duration(currentMoment.diff(previousMoment));\n        prevBySameAuthor = previous.author === current.author;\n        \n        if (prevBySameAuthor && previousDuration.as('hours') < 1) {\n          startsSequence = false;\n        }\n\n        if (previousDuration.as('hours') < 1) {\n          showTimestamp = false;\n        }\n      }\n\n      if (next) {\n        let nextMoment = moment(next.timestamp);\n        let nextDuration = moment.duration(nextMoment.diff(currentMoment));\n        nextBySameAuthor = next.author === current.author;\n\n        if (nextBySameAuthor && nextDuration.as('hours') < 1) {\n          endsSequence = false;\n        }\n      }\n        console.log(isMine);\n      tempMessages.push(\n        <Message\n          key={i}\n          isMine={isMine}\n          startsSequence={false}\n          endsSequence={false}\n          showTimestamp={showTimestamp}\n          data={current}\n        />\n      );\n\n      // Proceed to the next message.\n      i += 1;\n    }\n\n    return tempMessages;\n  }\n\n    return(\n      <div className=\"message-list\">\n        <Toolbar\n          title=\"Conversation Title\"\n          rightItems={[\n            <ToolbarButton key=\"info\" icon=\"ion-ios-information-circle-outline\" />,\n            <ToolbarButton key=\"video\" icon=\"ion-ios-videocam\" />,\n            <ToolbarButton key=\"phone\" icon=\"ion-ios-call\" />\n          ]}\n        />\n\n        <div className=\"message-list-container\">{renderMessages()}</div>\n\n            <Form className=\"compose\" onSubmit={handleSubmit}>\n                <input\n                    type=\"text\"\n                    className=\"compose-input\"\n                    placeholder=\"Type a message, @name\"\n                />\n                <Button type=\"submit\" color=\"primary\" className=\"bi bi-send\">\n                    Send\n                </Button>\n\n                {\n                   // props.rightItems\n                }\n            </Form>\n      </div>\n    );\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}